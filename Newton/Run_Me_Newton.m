clc, clear, close all

global ms m1 m2 m3 a b c L1 L2 L3 L4 Radius tau1 tau2 tau3

ms = 2000; m1 = 30; m2 = 20; m3 = 10;
a = 2; b = 1.8; c = 1.9; L1=0.5; L2=0.75; L3=1; L4=1; Radius=0.5;
tau1=0; tau2=0; tau3=0;

z0 = [zeros(9,1); 0; 0; 30; 30; 15; -20; 50; -25; 10];
options = odeset('maxstep',0.001);
% options = [];
[t,z] = ode45(@Satellite_Dynamics_Newton,0:0.01:0.2,z0,options);

q1 = z(:,1); q2 = z(:,2); q3 = z(:,3); q4 = z(:,4); q5 = z(:,5); q6 = z(:,6); q7 = z(:,7); q8 = z(:,8); q9 = z(:,9);
dq1 = z(:,10); dq2 = z(:,11); dq3 = z(:,12); dq4 = z(:,13); dq5 = z(:,14); dq6 = z(:,15); dq7 = z(:,16); dq8 = z(:,17); dq9 = z(:,18);

figure
hold on
plot(t,dq1,'r-','linewidth',4)
plot(t,dq2,'b--','linewidth',4)
plot(t,dq3,'g-','linewidth',4)
legend('X','Y','Z')
set(gca,'fontsize',18,'fontweight','bold');
xlabel('Time (s)','fontsize',18,'fontweight','bold');
ylabel('Satellite Global Position (m)','fontsize',18,'fontweight','bold');

figure
hold on
plot(t,dq4,'r-','linewidth',4)
plot(t,dq5,'b--','linewidth',4)
plot(t,dq6,'g-','linewidth',4)
legend('\psi','\theta','\phi')
set(gca,'fontsize',18,'fontweight','bold');
xlabel('Time (s)','fontsize',18,'fontweight','bold');
ylabel('Satellite Euler Angles (rad)','fontsize',18,'fontweight','bold');

figure
hold on
plot(t,dq7,'r-','linewidth',4)
plot(t,dq8,'b--','linewidth',4)
plot(t,dq9,'g-','linewidth',4)
legend('\theta1','\theta2','\theta3')
set(gca,'fontsize',18,'fontweight','bold');
xlabel('Time (s)','fontsize',18,'fontweight','bold');
ylabel('Arm Angles (rad)','fontsize',18,'fontweight','bold');

% Checking Energy Conservation
E=t;
for i=1:length(t)
    E(i)=(m2*((sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))))^2 + (sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))^2 + ((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))^2))/2 + (ms*(dq1(i)^2 + dq2(i)^2 + dq3(i)^2))/2 + (m1*((sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2)^2 + (sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))^2 + (dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i)))^2))/2 + (m3*((sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2)^2 + (cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))^2 + ((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))^2))/2 + (m3*(L4^2 + 3*Radius^2)*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))*((cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + (sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2))/12 + (Radius^2*m2*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))*((sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))))/2 - (cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2))/2 + (m1*(L2^2 + 3*Radius^2)*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))*((cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))))/2 + (sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))/2))/12 + (m1*(L2^2 + 3*Radius^2)*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))))*((cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))/2 - (sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))))/2))/12 + (m2*(L3^2 + 3*Radius^2)*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))))*(dq8(i)/2 + (cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))/2 - (sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))))/2))/12 + (Radius^2*m1*(dq7(i)/2 - (dq5(i)*sin(q6(i)))/2 + (dq4(i)*cos(q5(i))*cos(q6(i)))/2)*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))))/2 + (ms*(dq5(i)*sin(q6(i)) - dq4(i)*cos(q5(i))*cos(q6(i)))*((dq5(i)*sin(q6(i)))/2 - (dq4(i)*cos(q5(i))*cos(q6(i)))/2)*(a^2 + b^2))/12 + (ms*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*((dq5(i)*cos(q6(i)))/2 + (dq4(i)*cos(q5(i))*sin(q6(i)))/2)*(a^2 + c^2))/12 + (m3*(L4^2 + 3*Radius^2)*(dq8(i)/2 + dq9(i)/2 + (cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))/2 - (sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))))/2)*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/12 + (m2*(L3^2 + 3*Radius^2)*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))*((cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))))/2 + (sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2))/12 + (Radius^2*m3*(cos(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) - sin(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))*((cos(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 - (sin(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2))/2 + (ms*(dq6(i) - dq4(i)*sin(q5(i)))*(dq6(i)/2 - (dq4(i)*sin(q5(i)))/2)*(b^2 + c^2))/12;
end

figure
plot(t,100*(E-E(1))/E(1),'r-','linewidth',4)
set(gca,'fontsize',18,'fontweight','bold');
ylabel('Relative Error of Energy % ','fontsize',18,'fontweight','bold');
xlabel('Time (s)','fontsize',18,'fontweight','bold');

% Checking Linear Momentum Conservation
Linear_Momentumx = t;
Linear_Momentumy = t;
Linear_Momentumz = t;

for i=1:length(t)
    Linear_Momentumx(i) = dq1(i)*ms + m3*((cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2) + (cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))) + (cos(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) - sin(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))))*((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))) + m2*((cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i)))) + (sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))*((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + (cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) + m1*((sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + (cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2) + (sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i)))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))));
    Linear_Momentumy(i) = dq2(i)*ms - m1*((cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + (cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2) + (sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i)))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) - m3*((cos(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) - sin(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))))*((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) + (cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2) + (cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))))) - m2*((cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i)))) + (sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))*((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + (cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))));
    Linear_Momentumz(i) =                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         m1*((cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i)))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))) - (sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2) + cos(q5(i))*cos(q6(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i)))) + dq3(i)*ms + m3*((cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(cos(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))) + sin(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i)))) + (cos(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))) - sin(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))))*((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) - (sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2)) + m2*((sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))) - (sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i)))) + (sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i)))*((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))));
end
% 
figure
hold on
plot(t,(Linear_Momentumx-Linear_Momentumx(1))/Linear_Momentumx(1)*100,'r-','linewidth',4)
plot(t,(Linear_Momentumy-Linear_Momentumy(1))/Linear_Momentumy(1)*100,'b--','linewidth',4)
plot(t,(Linear_Momentumz-Linear_Momentumz(1))/Linear_Momentumz(1)*100,'g-','linewidth',4)
set(gca,'fontsize',18,'fontweight','bold');
ylabel('Relative Error of Linear Momentum % ','fontsize',18,'fontweight','bold');
xlabel('Time (s)','fontsize',18,'fontweight','bold');
legend('P_c_m_X','P_c_m_Y','P_c_m_Z')

% Checksing Angular Momentum Conservation
Angular_Momentumx = t;
Angular_Momentumy = t;
Angular_Momentumz = t;

for i=1:length(t)
    Angular_Momentumx(i) =                                                                                                                                                                                                                                                                                                                 m2*(q2(i) - (cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(L1 + L2) + (L3*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))))/2)*((sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))) - (sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i)))) + (sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i)))*((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) + m1*(q3(i) - (L2*cos(q5(i))*cos(q6(i)))/2 + cos(q5(i))*cos(q6(i))*(L1 + L2))*((cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + (cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2) + (sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i)))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + m3*((cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(cos(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))) + sin(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i)))) + (cos(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))) - sin(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))))*((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) - (sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2))*(q2(i) - (L4*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))))/2 - (cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(L1 + L2) + L3*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))) + m2*((cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i)))) + (sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))*((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + (cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(q3(i) - (L3*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))))/2 + cos(q5(i))*cos(q6(i))*(L1 + L2)) + m3*((cos(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) - sin(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))))*((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) + (cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2) + (cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))))*(q3(i) + (L4*(cos(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))) + sin(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i)))))/2 - L3*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))) + cos(q5(i))*cos(q6(i))*(L1 + L2)) - dq2(i)*ms*q3(i) + dq3(i)*ms*q2(i) + m1*((cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i)))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))) - (sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2) + cos(q5(i))*cos(q6(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))))*(q2(i) + (L2*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))/2 - (cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(L1 + L2)) + (Radius^2*m2*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 - (m3*(L4^2 + 3*Radius^2)*(cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/12 - (Radius^2*m3*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))))*(cos(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) - sin(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2 - (m2*(L3^2 + 3*Radius^2)*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/12 - (m1*(L2^2 + 3*Radius^2)*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))))/12 - (m1*(L2^2 + 3*Radius^2)*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))))*(cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i))))/12 - (ms*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(dq5(i)*sin(q6(i)) - dq4(i)*cos(q5(i))*cos(q6(i)))*(a^2 + b^2))/12 - (ms*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i)))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(a^2 + c^2))/12 + (Radius^2*m1*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))))/2 + (m3*(L4^2 + 3*Radius^2)*(cos(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) - sin(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))))*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/12 - (m2*(L3^2 + 3*Radius^2)*(cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/12 + (ms*cos(q4(i))*cos(q5(i))*(dq6(i) - dq4(i)*sin(q5(i)))*(b^2 + c^2))/12;
    Angular_Momentumy(i) =                                                                                                                                                                                                                                                                                                             m1*(q3(i) - (L2*cos(q5(i))*cos(q6(i)))/2 + cos(q5(i))*cos(q6(i))*(L1 + L2))*((sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + (cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2) + (sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i)))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) - m3*((cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(cos(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))) + sin(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i)))) + (cos(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))) - sin(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))))*((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) - (sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2))*(q1(i) + (L4*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))))/2 + (sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(L1 + L2) - L3*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))) + m3*((cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2) + (cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))) + (cos(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) - sin(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))))*((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))))*(q3(i) + (L4*(cos(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))) + sin(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i)))))/2 - L3*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))) + cos(q5(i))*cos(q6(i))*(L1 + L2)) - m2*(q1(i) + (sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(L1 + L2) - (L3*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))))/2)*((sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))) - (sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i)))) + (sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i)))*((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) + m2*(q3(i) - (L3*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))))/2 + cos(q5(i))*cos(q6(i))*(L1 + L2))*((cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i)))) + (sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))*((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + (cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) + dq1(i)*ms*q3(i) - dq3(i)*ms*q1(i) - m1*((cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i)))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))) - (sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2) + cos(q5(i))*cos(q6(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))))*(q1(i) - (L2*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))/2 + (sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(L1 + L2)) - (m3*(L4^2 + 3*Radius^2)*(cos(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) - sin(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))))*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/12 + (m2*(cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(L3^2 + 3*Radius^2)*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/12 - (Radius^2*m2*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + (m3*(cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(L4^2 + 3*Radius^2)*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/12 + (ms*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(dq5(i)*sin(q6(i)) - dq4(i)*cos(q5(i))*cos(q6(i)))*(a^2 + b^2))/12 + (ms*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i)))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(a^2 + c^2))/12 + (Radius^2*m3*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))))*(cos(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) - sin(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2 + (m2*(L3^2 + 3*Radius^2)*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/12 + (m1*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i)))*(L2^2 + 3*Radius^2)*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/12 + (m1*(cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(L2^2 + 3*Radius^2)*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/12 - (Radius^2*m1*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))))/2 + (ms*cos(q5(i))*sin(q4(i))*(dq6(i) - dq4(i)*sin(q5(i)))*(b^2 + c^2))/12;
    Angular_Momentumz(i) = dq2(i)*ms*q1(i) - m2*(q2(i) - (cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(L1 + L2) + (L3*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))))/2)*((cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i)))) + (sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))*((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + (cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) - m2*((cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - (L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))/2 + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i)))) + (sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))*((L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + (cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(q1(i) + (sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(L1 + L2) - (L3*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))))/2) - dq1(i)*ms*q2(i) - m3*((cos(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) - sin(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))))*((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))) + (cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2) + (cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))))*(q1(i) + (L4*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))))/2 + (sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(L1 + L2) - L3*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))) - m1*((sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + (cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2) + (sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i)))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))*(q2(i) + (L2*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))/2 - (cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(L1 + L2)) - m1*((cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + (cos(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q5(i))*sin(q4(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - (L2*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/2) + (sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i)))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L2*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))*(q1(i) - (L2*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))/2 + (sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))*(L1 + L2)) - m3*((cos(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q4(i))*cos(q5(i))*sin(q7(i)))*(sin(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))) - L3*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + cos(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) + (L4*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))))/2) + (cos(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + sin(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))))*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))))) + (cos(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) + sin(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))) - sin(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - cos(q4(i))*cos(q5(i))*cos(q7(i))) - cos(q8(i))*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)))))*((L4*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/2 - sin(q9(i))*(L3*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))) - cos(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i))))) + cos(q9(i))*(sin(q8(i))*(dq1(i)*(sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i))) - dq2(i)*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))) + dq3(i)*cos(q5(i))*cos(q6(i))) + cos(q8(i))*(sin(q7(i))*(dq1(i)*(cos(q6(i))*sin(q4(i)) - cos(q4(i))*sin(q5(i))*sin(q6(i))) - dq2(i)*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + (dq6(i) - dq4(i)*sin(q5(i)))*(L1 + L2) - dq3(i)*cos(q5(i))*sin(q6(i))) - cos(q7(i))*((dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(L1 + L2) - dq3(i)*sin(q5(i)) + dq1(i)*cos(q4(i))*cos(q5(i)) + dq2(i)*cos(q5(i))*sin(q4(i)))))))*(q2(i) - (L4*(cos(q9(i))*(sin(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) - cos(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))) + sin(q9(i))*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))))/2 - (cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i)))*(L1 + L2) + L3*(cos(q8(i))*(sin(q7(i))*(cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i))) + cos(q5(i))*cos(q7(i))*sin(q4(i))) + sin(q8(i))*(cos(q4(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i))*sin(q5(i))))) - (ms*sin(q5(i))*(dq6(i) - dq4(i)*sin(q5(i)))*(b^2 + c^2))/12 + (m1*(L2^2 + 3*Radius^2)*(sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/12 - (m1*(L2^2 + 3*Radius^2)*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i)))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))/12 - (m2*(L3^2 + 3*Radius^2)*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))))/12 + (m3*(L4^2 + 3*Radius^2)*(cos(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) + sin(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))*(cos(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))) - sin(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i)))))/12 + (m2*(L3^2 + 3*Radius^2)*(sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(dq8(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/12 + (Radius^2*m2*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i))))/2 + (m3*(L4^2 + 3*Radius^2)*(sin(q5(i))*sin(q7(i)) + cos(q5(i))*cos(q7(i))*sin(q6(i)))*(dq8(i) + dq9(i) + cos(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))) - sin(q7(i))*(dq6(i) - dq4(i)*sin(q5(i)))))/12 - (Radius^2*m3*(cos(q9(i))*(cos(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) + sin(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))) - sin(q9(i))*(sin(q8(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))) - cos(q8(i))*(cos(q7(i))*(dq6(i) - dq4(i)*sin(q5(i))) + sin(q7(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i))))))*(cos(q9(i))*(sin(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) - cos(q5(i))*cos(q6(i))*cos(q8(i))) + sin(q9(i))*(cos(q8(i))*(cos(q7(i))*sin(q5(i)) - cos(q5(i))*sin(q6(i))*sin(q7(i))) + cos(q5(i))*cos(q6(i))*sin(q8(i)))))/2 + (Radius^2*m1*cos(q5(i))*cos(q6(i))*(dq7(i) - dq5(i)*sin(q6(i)) + dq4(i)*cos(q5(i))*cos(q6(i))))/2 - (ms*cos(q5(i))*cos(q6(i))*(dq5(i)*sin(q6(i)) - dq4(i)*cos(q5(i))*cos(q6(i)))*(a^2 + b^2))/12 + (ms*cos(q5(i))*sin(q6(i))*(dq5(i)*cos(q6(i)) + dq4(i)*cos(q5(i))*sin(q6(i)))*(a^2 + c^2))/12;
end

figure
hold on
plot(t,(Angular_Momentumx-Angular_Momentumx(1))/Angular_Momentumx(1)*100,'r-','linewidth',4)
plot(t,(Angular_Momentumy-Angular_Momentumy(1))/Angular_Momentumy(1)*100,'b--','linewidth',4)
plot(t,(Angular_Momentumz-Angular_Momentumz(1))/Angular_Momentumz(1)*100,'g-','linewidth',4)
set(gca,'fontsize',18,'fontweight','bold');
ylabel('Relative Error of Angular Momentum % ','fontsize',18,'fontweight','bold');
xlabel('Time (s)','fontsize',18,'fontweight','bold');
legend('H_X','H_Y','H_Z')

%%
%ANIMATION PART
figure
hold on

Len=length(t);
Xcm=t; Ycm=t; Zcm=t;
for i=1:Len
    R = [                          cos(q4(i))*cos(q5(i)),                           cos(q5(i))*sin(q4(i)),        -sin(q5(i))
        cos(q4(i))*sin(q5(i))*sin(q6(i)) - cos(q6(i))*sin(q4(i)), cos(q4(i))*cos(q6(i)) + sin(q4(i))*sin(q5(i))*sin(q6(i)), cos(q5(i))*sin(q6(i))
        sin(q4(i))*sin(q6(i)) + cos(q4(i))*cos(q6(i))*sin(q5(i)), cos(q6(i))*sin(q4(i))*sin(q5(i)) - cos(q4(i))*sin(q6(i)), cos(q5(i))*cos(q6(i))];
    
    R1 = [cos(q7(i)) -sin(q7(i)) 0; sin(q7(i)) cos(q7(i)) 0; 0 0 1]; % From the first arm coordinates to the body one.
    R2 = [cos(q8(i)) -sin(q8(i)) 0; 0 0 1; -sin(q8(i)) -cos(q8(i)) 0]; % From the second arm coordinates to the first one.
    R3 = [cos(q9(i)) -sin(q9(i)) 0; sin(q9(i)) cos(q9(i)) 0; 0 0 1]; % From the thrid arm coodinate to the second one.


    Rt=R';
    PG = [q1(i); q2(i); q3(i)];
    P1 = PG + Rt*1/2*[-a; -b; -c];
    P2 = PG + Rt*1/2*[+a; -b; -c];
    P3 = PG + Rt*1/2*[+a; -b; +c];
    P4 = PG + Rt*1/2*[-a; -b; +c];
    P5 = PG + Rt*1/2*[-a; +b; -c];
    P6 = PG + Rt*1/2*[+a; +b; -c];
    P7 = PG + Rt*1/2*[+a; +b; +c];
    P8 = PG + Rt*1/2*[-a; +b; +c];
    P_sG = PG + Rt*1/2*[0; 0; c];
    P_p1 = P_sG + Rt*[0; 0; L1];
    
    P_p2 = P_p1 + Rt*[0; 0; L2];
    P_p3 = P_p2 + Rt*R1*R2*[L3; 0; 0];
    P_p4 = P_p3 + Rt*R1*R2*R3*[0; L4; 0];
    
    V12 = [P1, P2]; V23 = [P2, P3]; V34 = [P3, P4]; V14 = [P1, P4];
    V56 = [P5, P6]; V67 = [P6, P7]; V78 = [P7, P8]; V58 = [P5, P8];
    V15 = [P1, P5]; V48 = [P4, P8]; V26 = [P2, P6]; V37 = [P3, P7];
    Vp1psG = [P_p1, P_sG];
    
    Vp1p2 = [P_p1, P_p2]; Vp2p3 = [P_p2, P_p3]; Vp3p4 = [P_p3, P_p4];
    
    plot3(V12(1,:),V12(2,:),V12(3,:),'linewidth',4)
    hold on
    plot3(V23(1,:),V23(2,:),V23(3,:),'linewidth',4)
    plot3(V34(1,:),V34(2,:),V34(3,:),'linewidth',4)
    plot3(V14(1,:),V14(2,:),V14(3,:),'linewidth',4)
    plot3(V56(1,:),V56(2,:),V56(3,:),'linewidth',4)
    plot3(V67(1,:),V67(2,:),V67(3,:),'linewidth',4)
    plot3(V78(1,:),V78(2,:),V78(3,:),'linewidth',4)
    plot3(V58(1,:),V58(2,:),V58(3,:),'linewidth',4)
    plot3(V15(1,:),V15(2,:),V15(3,:),'linewidth',4)
    plot3(V48(1,:),V48(2,:),V48(3,:),'linewidth',4)
    plot3(V26(1,:),V26(2,:),V26(3,:),'linewidth',4)
    plot3(V37(1,:),V37(2,:),V37(3,:),'linewidth',4)
    
    plot3(Vp1psG(1,:),Vp1psG(2,:),Vp1psG(3,:),'b-','linewidth',4)
    
    plot3(Vp1p2(1,:),Vp1p2(2,:),Vp1p2(3,:),'r-','linewidth',3)
    plot3(Vp2p3(1,:),Vp2p3(2,:),Vp2p3(3,:),'r-','linewidth',3)
    plot3(Vp3p4(1,:),Vp3p4(2,:),Vp3p4(3,:),'r-','linewidth',3)
        
    axis equal
    axis([q1(i)- 2*a  (q1(i)+ 2*a) (q2(i)- 2*b) (q2(i)+2*b)  (q3(i)- 2*c) (q3(i)+2*c)])
    str=['Time = ',num2str(t(i))];
    text(q1(i),q2(i),str)
    xlabel('X Location','fontsize',10,'fontweight','bold');
    ylabel('Y Location','fontsize',10,'fontweight','bold');
    zlabel('Z Location','fontsize',10,'fontweight','bold');
    
    hold off
    pause(0.01)
end


